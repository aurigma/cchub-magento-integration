window.Aurigma=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=54)}([function(t,e,n){"use strict";var r=n(7),i=Object.prototype.toString;function o(t){return"[object Array]"===i.call(t)}function s(t){return void 0===t}function a(t){return null!==t&&"object"==typeof t}function c(t){if("[object Object]"!==i.call(t))return!1;var e=Object.getPrototypeOf(t);return null===e||e===Object.prototype}function u(t){return"[object Function]"===i.call(t)}function p(t,e){if(null!=t)if("object"!=typeof t&&(t=[t]),o(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.call(null,t[i],i,t)}t.exports={isArray:o,isArrayBuffer:function(t){return"[object ArrayBuffer]"===i.call(t)},isBuffer:function(t){return null!==t&&!s(t)&&null!==t.constructor&&!s(t.constructor)&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)},isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:a,isPlainObject:c,isUndefined:s,isDate:function(t){return"[object Date]"===i.call(t)},isFile:function(t){return"[object File]"===i.call(t)},isBlob:function(t){return"[object Blob]"===i.call(t)},isFunction:u,isStream:function(t){return a(t)&&u(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:p,merge:function t(){var e={};function n(n,r){c(e[r])&&c(n)?e[r]=t(e[r],n):c(n)?e[r]=t({},n):o(n)?e[r]=n.slice():e[r]=n}for(var r=0,i=arguments.length;r<i;r++)p(arguments[r],n);return e},extend:function(t,e,n){return p(e,(function(e,i){t[i]=n&&"function"==typeof e?r(e,n):e})),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(t){return 65279===t.charCodeAt(0)&&(t=t.slice(1)),t}}},,function(t,e,n){t.exports=n(19)},function(t,e,n){"use strict";var r,i,o;!function(t){t[t.Custom=0]="Custom",t[t.Shopify=1]="Shopify",t[t.DocketManager=2]="DocketManager",t[t.Auth0Saml=3]="Auth0Saml",t[t.NopCommerce=4]="NopCommerce",t[t.WooCommerce=5]="WooCommerce",t[t.Magento=6]="Magento",t[t.BigCommerce=7]="BigCommerce"}(r||(r={})),function(t){t[t.UIFramework=0]="UIFramework",t[t.SimpleEditor=1]="SimpleEditor"}(i||(i={}));!function(t){t[t.Template=1]="Template",t[t.OptionBasedProduct=2]="OptionBasedProduct"}(o||(o={}));n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";function r(t,e){return"string"==typeof t?i(t,e):Promise.all(t.map(t=>i(t.importData,t.url,t.isDefault)))}function i(t,e,n=!1){return new Promise((r,i)=>{const o="resolve_callback_"+Math.round(1e5*Math.random());window[o]=(...e)=>{delete window[o],document.head.removeChild(s);const n=Array.from(e);let i=t.split(",");i=i.map(t=>t.trim());const a=n.reduce((t,e,n)=>(t[i[n]]=e,t),{});r(a)};const s=document.createElement("script");s.type="module",s.onerror=t=>{console.error("Failer load script from "+e),console.error(t),i(t)},e+=(e.indexOf("?")>=0?"&":"?")+"t="+Date.now(),s.text=n?`import ${t} from '${e}'; ${o}(${t}.default || ${t} );`:`import { ${t} } from '${e}'; ${o}(${t});`,document.head.appendChild(s)})}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SignalList=e.SignalHandlingBase=e.SignalDispatcher=void 0;var r=n(37);Object.defineProperty(e,"SignalDispatcher",{enumerable:!0,get:function(){return r.SignalDispatcher}}),Object.defineProperty(e,"SignalHandlingBase",{enumerable:!0,get:function(){return r.SignalHandlingBase}}),Object.defineProperty(e,"SignalList",{enumerable:!0,get:function(){return r.SignalList}})},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2),i=n.n(r);class o{constructor(t,e,n){this.apiUrl=null!=e?e:"https://customerscanvashub.com/",this.tenantId=t,this.ecommerceSystemId=null!=n?n:0,this.http=i.a.create({baseURL:null!=e?e:"https://customerscanvashub.com/",validateStatus:t=>t>=200&&t<300})}async getIntegrationInfo(t){const e=0==this.ecommerceSystemId?`/api/v1/tenants/${this.tenantId}/integrations/${t}`:`/api/v1/tenants/${this.tenantId}/integrations/${t}?storefrontId=${this.ecommerceSystemId}`,n=await this.http.get(e);return this.getDataFrom(n)}async getTemplateIntegrationInfo(t){const e=await this.http.get(`/api/v1/tenants/${this.tenantId}/integrations/template/${t}`);return this.getDataFrom(e)}async getOptionBasedProductIntegrationInfo(t,e){let n=`/api/v1/tenants/${this.tenantId}/integrations/option-based-product/${t}`;null!=e&&(n+="?productFilterId="+e);const r=await this.http.get(n);return this.getDataFrom(r)}async getToken(t,e){const n=await this.http.post(`/api/v1/tenants/${this.tenantId}/integrations/gettoken`,{userGuid:t,ecommerceDomain:e,origin:window.location.origin});return this.getDataFrom(n)}async getTokenAndUserId(t,e){const n={userGuid:t,ecommerceDomain:e,origin:window.location.origin,storefrontId:0==this.ecommerceSystemId?null:this.ecommerceSystemId.toString()},r=await this.http.post(`/api/v1/tenants/${this.tenantId}/integrations/getusertoken`,n);return this.getDataFrom(r)}async getCcToken(t,e){const n=await this.http.post(`/api/v1/tenants/${this.tenantId}/integrations/getcctoken`,{userGuid:t,ecommerceDomain:e,origin:window.location.origin});return this.getDataFrom(n)}async updateCcToken(t){await this.http.post(`/api/v1/tenants/${this.tenantId}/integrations/updatecctoken`,{userToken:t,origin:window.location.origin})}getAdditionalProducts(t,e,n){const r="https://customerscanvashub.com/"+`api/v1/tenants/${t}/integrations/GetAdditionalProducts`,i={origin:window.location.origin,ecommerceDomain:e,additionalProducts:n};return fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then(t=>t.json()).then(t=>{if(t.success)return t.result;throw new Error(t.error)})}getDataFrom(t){if(!this.http.defaults.validateStatus(t.status)||!t.data.success)throw new Error(`HTTP ${t.status} ${t.statusText}. ${JSON.stringify(t.data)}`);return t.data.result}}},function(t,e,n){"use strict";t.exports=function(t,e){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return t.apply(e,n)}}},function(t,e,n){"use strict";var r=n(0);function i(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,n){if(!e)return t;var o;if(n)o=n(e);else if(r.isURLSearchParams(e))o=e.toString();else{var s=[];r.forEach(e,(function(t,e){null!=t&&(r.isArray(t)?e+="[]":t=[t],r.forEach(t,(function(t){r.isDate(t)?t=t.toISOString():r.isObject(t)&&(t=JSON.stringify(t)),s.push(i(e)+"="+i(t))})))})),o=s.join("&")}if(o){var a=t.indexOf("#");-1!==a&&(t=t.slice(0,a)),t+=(-1===t.indexOf("?")?"?":"&")+o}return t}},function(t,e,n){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,n){"use strict";(function(e){var r=n(0),i=n(25),o={"Content-Type":"application/x-www-form-urlencoded"};function s(t,e){!r.isUndefined(t)&&r.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var a,c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==e&&"[object process]"===Object.prototype.toString.call(e))&&(a=n(11)),a),transformRequest:[function(t,e){return i(e,"Accept"),i(e,"Content-Type"),r.isFormData(t)||r.isArrayBuffer(t)||r.isBuffer(t)||r.isStream(t)||r.isFile(t)||r.isBlob(t)?t:r.isArrayBufferView(t)?t.buffer:r.isURLSearchParams(t)?(s(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):r.isObject(t)?(s(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(t){return t>=200&&t<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},r.forEach(["delete","get","head"],(function(t){c.headers[t]={}})),r.forEach(["post","put","patch"],(function(t){c.headers[t]=r.merge(o)})),t.exports=c}).call(this,n(24))},function(t,e,n){"use strict";var r=n(0),i=n(26),o=n(28),s=n(8),a=n(29),c=n(32),u=n(33),p=n(12);t.exports=function(t){return new Promise((function(e,n){var f=t.data,l=t.headers;r.isFormData(f)&&delete l["Content-Type"];var d=new XMLHttpRequest;if(t.auth){var h=t.auth.username||"",m=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";l.Authorization="Basic "+btoa(h+":"+m)}var v=a(t.baseURL,t.url);if(d.open(t.method.toUpperCase(),s(v,t.params,t.paramsSerializer),!0),d.timeout=t.timeout,d.onreadystatechange=function(){if(d&&4===d.readyState&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in d?c(d.getAllResponseHeaders()):null,o={data:t.responseType&&"text"!==t.responseType?d.response:d.responseText,status:d.status,statusText:d.statusText,headers:r,config:t,request:d};i(e,n,o),d=null}},d.onabort=function(){d&&(n(p("Request aborted",t,"ECONNABORTED",d)),d=null)},d.onerror=function(){n(p("Network Error",t,null,d)),d=null},d.ontimeout=function(){var e="timeout of "+t.timeout+"ms exceeded";t.timeoutErrorMessage&&(e=t.timeoutErrorMessage),n(p(e,t,"ECONNABORTED",d)),d=null},r.isStandardBrowserEnv()){var b=(t.withCredentials||u(v))&&t.xsrfCookieName?o.read(t.xsrfCookieName):void 0;b&&(l[t.xsrfHeaderName]=b)}if("setRequestHeader"in d&&r.forEach(l,(function(t,e){void 0===f&&"content-type"===e.toLowerCase()?delete l[e]:d.setRequestHeader(e,t)})),r.isUndefined(t.withCredentials)||(d.withCredentials=!!t.withCredentials),t.responseType)try{d.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&d.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then((function(t){d&&(d.abort(),n(t),d=null)})),f||(f=null),d.send(f)}))}},function(t,e,n){"use strict";var r=n(27);t.exports=function(t,e,n,i,o){var s=new Error(t);return r(s,e,n,i,o)}},function(t,e,n){"use strict";var r=n(0);t.exports=function(t,e){e=e||{};var n={},i=["url","method","data"],o=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function c(t,e){return r.isPlainObject(t)&&r.isPlainObject(e)?r.merge(t,e):r.isPlainObject(e)?r.merge({},e):r.isArray(e)?e.slice():e}function u(i){r.isUndefined(e[i])?r.isUndefined(t[i])||(n[i]=c(void 0,t[i])):n[i]=c(t[i],e[i])}r.forEach(i,(function(t){r.isUndefined(e[t])||(n[t]=c(void 0,e[t]))})),r.forEach(o,u),r.forEach(s,(function(i){r.isUndefined(e[i])?r.isUndefined(t[i])||(n[i]=c(void 0,t[i])):n[i]=c(void 0,e[i])})),r.forEach(a,(function(r){r in e?n[r]=c(t[r],e[r]):r in t&&(n[r]=c(void 0,t[r]))}));var p=i.concat(o).concat(s).concat(a),f=Object.keys(t).concat(Object.keys(e)).filter((function(t){return-1===p.indexOf(t)}));return r.forEach(f,u),n}},function(t,e,n){"use strict";function r(t){this.message=t}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,t.exports=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Subscription=void 0;var r=function(){function t(t,e){this.handler=t,this.isOnce=e,this.isExecuted=!1}return t.prototype.execute=function(t,e,n){if(!this.isOnce||!this.isExecuted){this.isExecuted=!0;var r=this.handler;t?setTimeout((function(){r.apply(e,n)}),1):r.apply(e,n)}},t}();e.Subscription=r},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));class r{constructor(t){this.getCookies=()=>{const t=this._doc.cookie;return t?t.split(";").reduce((t,e,n,r)=>{const i=e.split("=");if(2!==i.length)throw new Error("Each cookie should be an equal sign separated string.");return t[i[0].trim()]=i[1],t},{}):{}},this._doc=t}getLanguage(){const t=this._doc.querySelector("html").getAttribute("lang");return Boolean(t)?t.substr(0,2):"en"}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(2),i=n.n(r);class o{constructor({url:t,tenantId:e,http:n}){this.apiUrl=t,this.tenantId=e,this.http=null!=n?n:i.a}async warmUp(t,e,n){for(let r=0;r<t;r++){const i=await this.http.get(this.apiUrl+"/ping");switch(i.status){case 200:case 201:case 204:return!0;case 503:if(r<t-1){const t=new Promise(t=>setTimeout(t,1e3*e));Boolean(n)&&n(),await t}break;default:throw new Error(`Unexpected response from service: HTTP ${i.status} ${i.statusText}`)}}return!1}async post(t){return(await this.http.post(`${this.apiUrl}/tenants/${this.tenantId}/projects/create`,t,{headers:{"Content-Type":"application/json"}})).data}}},,function(t,e,n){"use strict";var r=n(0),i=n(7),o=n(20),s=n(13);function a(t){var e=new o(t),n=i(o.prototype.request,e);return r.extend(n,o.prototype,e),r.extend(n,e),n}var c=a(n(10));c.Axios=o,c.create=function(t){return a(s(c.defaults,t))},c.Cancel=n(14),c.CancelToken=n(34),c.isCancel=n(9),c.all=function(t){return Promise.all(t)},c.spread=n(35),c.isAxiosError=n(36),t.exports=c,t.exports.default=c},function(t,e,n){"use strict";var r=n(0),i=n(8),o=n(21),s=n(22),a=n(13);function c(t){this.defaults=t,this.interceptors={request:new o,response:new o}}c.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=a(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var e=[s,void 0],n=Promise.resolve(t);for(this.interceptors.request.forEach((function(t){e.unshift(t.fulfilled,t.rejected)})),this.interceptors.response.forEach((function(t){e.push(t.fulfilled,t.rejected)}));e.length;)n=n.then(e.shift(),e.shift());return n},c.prototype.getUri=function(t){return t=a(this.defaults,t),i(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(t){c.prototype[t]=function(e,n){return this.request(a(n||{},{method:t,url:e,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(t){c.prototype[t]=function(e,n,r){return this.request(a(r||{},{method:t,url:e,data:n}))}})),t.exports=c},function(t,e,n){"use strict";var r=n(0);function i(){this.handlers=[]}i.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},i.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},i.prototype.forEach=function(t){r.forEach(this.handlers,(function(e){null!==e&&t(e)}))},t.exports=i},function(t,e,n){"use strict";var r=n(0),i=n(23),o=n(9),s=n(10);function a(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return a(t),t.headers=t.headers||{},t.data=i(t.data,t.headers,t.transformRequest),t.headers=r.merge(t.headers.common||{},t.headers[t.method]||{},t.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete t.headers[e]})),(t.adapter||s.adapter)(t).then((function(e){return a(t),e.data=i(e.data,e.headers,t.transformResponse),e}),(function(e){return o(e)||(a(t),e&&e.response&&(e.response.data=i(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)}))}},function(t,e,n){"use strict";var r=n(0);t.exports=function(t,e,n){return r.forEach(n,(function(n){t=n(t,e)})),t}},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var c,u=[],p=!1,f=-1;function l(){p&&c&&(p=!1,c.length?u=c.concat(u):f=-1,u.length&&d())}function d(){if(!p){var t=a(l);p=!0;for(var e=u.length;e;){for(c=u,u=[];++f<e;)c&&c[f].run();f=-1,e=u.length}c=null,p=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function m(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new h(t,e)),1!==u.length||p||a(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";var r=n(0);t.exports=function(t,e){r.forEach(t,(function(n,r){r!==e&&r.toUpperCase()===e.toUpperCase()&&(t[e]=n,delete t[r])}))}},function(t,e,n){"use strict";var r=n(12);t.exports=function(t,e,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?e(r("Request failed with status code "+n.status,n.config,null,n.request,n)):t(n)}},function(t,e,n){"use strict";t.exports=function(t,e,n,r,i){return t.config=e,n&&(t.code=n),t.request=r,t.response=i,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},function(t,e,n){"use strict";var r=n(0);t.exports=r.isStandardBrowserEnv()?{write:function(t,e,n,i,o,s){var a=[];a.push(t+"="+encodeURIComponent(e)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(i)&&a.push("path="+i),r.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,n){"use strict";var r=n(30),i=n(31);t.exports=function(t,e){return t&&!r(e)?i(t,e):e}},function(t,e,n){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,n){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,n){"use strict";var r=n(0),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,n,o,s={};return t?(r.forEach(t.split("\n"),(function(t){if(o=t.indexOf(":"),e=r.trim(t.substr(0,o)).toLowerCase(),n=r.trim(t.substr(o+1)),e){if(s[e]&&i.indexOf(e)>=0)return;s[e]="set-cookie"===e?(s[e]?s[e]:[]).concat([n]):s[e]?s[e]+", "+n:n}})),s):s}},function(t,e,n){"use strict";var r=n(0);t.exports=r.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(t){var r=t;return e&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=i(window.location.href),function(e){var n=r.isString(e)?i(e):e;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}},function(t,e,n){"use strict";var r=n(14);function i(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise((function(t){e=t}));var n=this;t((function(t){n.reason||(n.reason=new r(t),e(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var t;return{token:new i((function(e){t=e})),cancel:t}},t.exports=i},function(t,e,n){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,n){"use strict";t.exports=function(t){return"object"==typeof t&&!0===t.isAxiosError}},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.SignalHandlingBase=e.SignalList=e.SignalDispatcher=void 0;var o=n(38),s=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.dispatch=function(){this._dispatch(!1,this,arguments)},e.prototype.dispatchAsync=function(){this._dispatch(!0,this,arguments)},e.prototype.asEvent=function(){return t.prototype.asEvent.call(this)},e}(o.DispatcherBase);e.SignalDispatcher=s;var a=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.createDispatcher=function(){return new s},e}(o.EventListBase);e.SignalList=a;var c=function(){function t(){this._events=new a}return Object.defineProperty(t.prototype,"events",{get:function(){return this._events},enumerable:!1,configurable:!0}),t.prototype.one=function(t,e){this._events.get(t).one(e)},t.prototype.has=function(t,e){return this._events.get(t).has(e)},t.prototype.subscribe=function(t,e){this._events.get(t).subscribe(e)},t.prototype.sub=function(t,e){this.subscribe(t,e)},t.prototype.unsubscribe=function(t,e){this._events.get(t).unsubscribe(e)},t.prototype.unsub=function(t,e){this.unsubscribe(t,e)},t}();e.SignalHandlingBase=c},function(t,e,n){"use strict";
/*!
 * Strongly Typed Events for TypeScript - Core
 * https://github.com/KeesCBakker/StronlyTypedEvents/
 * http://keestalkstech.com
 *
 * Copyright Kees C. Bakker / KeesTalksTech
 * Released under the MIT license
 */Object.defineProperty(e,"__esModule",{value:!0}),e.Subscription=e.EventListBase=e.DispatcherWrapper=e.DispatcherBase=void 0;var r=n(39);Object.defineProperty(e,"DispatcherBase",{enumerable:!0,get:function(){return r.DispatcherBase}}),Object.defineProperty(e,"DispatcherWrapper",{enumerable:!0,get:function(){return r.DispatcherWrapper}}),Object.defineProperty(e,"EventListBase",{enumerable:!0,get:function(){return r.EventListBase}});var i=n(15);Object.defineProperty(e,"Subscription",{enumerable:!0,get:function(){return i.Subscription}})},function(t,e,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r};Object.defineProperty(e,"__esModule",{value:!0}),e.DispatcherWrapper=e.EventListBase=e.DispatcherBase=void 0;var i=n(40),o=n(15),s=function(){function t(){this._wrap=new c(this),this._subscriptions=new Array}return Object.defineProperty(t.prototype,"count",{get:function(){return this._subscriptions.length},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t){var e=this;return t&&this._subscriptions.push(new o.Subscription(t,!1)),function(){e.unsubscribe(t)}},t.prototype.sub=function(t){return this.subscribe(t)},t.prototype.one=function(t){var e=this;return t&&this._subscriptions.push(new o.Subscription(t,!0)),function(){e.unsubscribe(t)}},t.prototype.has=function(t){return!!t&&this._subscriptions.some((function(e){return e.handler==t}))},t.prototype.unsubscribe=function(t){if(t)for(var e=0;e<this._subscriptions.length;e++)if(this._subscriptions[e].handler==t){this._subscriptions.splice(e,1);break}},t.prototype.unsub=function(t){this.unsubscribe(t)},t.prototype._dispatch=function(t,e,n){for(var o=this,s=function(r){var s=new i.EventManagement((function(){return o.unsub(r.handler)})),c=Array.prototype.slice.call(n);if(c.push(s),r.execute(t,e,c),a.cleanup(r),!t&&s.propagationStopped)return"break"},a=this,c=0,u=r(this._subscriptions);c<u.length;c++){if("break"===s(u[c]))break}},t.prototype.cleanup=function(t){if(t.isOnce&&t.isExecuted){var e=this._subscriptions.indexOf(t);e>-1&&this._subscriptions.splice(e,1)}},t.prototype.asEvent=function(){return this._wrap},t.prototype.clear=function(){this._subscriptions.splice(0,this._subscriptions.length)},t}();e.DispatcherBase=s;var a=function(){function t(){this._events={}}return t.prototype.get=function(t){var e=this._events[t];return e||(e=this.createDispatcher(),this._events[t]=e,e)},t.prototype.remove=function(t){delete this._events[t]},t}();e.EventListBase=a;var c=function(){function t(t){this._subscribe=function(e){return t.subscribe(e)},this._unsubscribe=function(e){return t.unsubscribe(e)},this._one=function(e){return t.one(e)},this._has=function(e){return t.has(e)},this._clear=function(){return t.clear()},this._count=function(){return t.count}}return Object.defineProperty(t.prototype,"count",{get:function(){return this._count()},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t){return this._subscribe(t)},t.prototype.sub=function(t){return this.subscribe(t)},t.prototype.unsubscribe=function(t){this._unsubscribe(t)},t.prototype.unsub=function(t){this.unsubscribe(t)},t.prototype.one=function(t){return this._one(t)},t.prototype.has=function(t){return this._has(t)},t.prototype.clear=function(){this._clear()},t}();e.DispatcherWrapper=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventManagement=void 0;var r=function(){function t(t){this.unsub=t,this.propagationStopped=!1}return t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}();e.EventManagement=r},function(t,e,n){"use strict";function r(){var t;let e=(new Date).getTime(),n=null!==(t=performance&&performance.now&&1e3*performance.now())&&void 0!==t?t:0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{var r=16*Math.random();return e>0?(r=(e+r)%16|0,e=Math.floor(e/16)):(r=(n+r)%16|0,n=Math.floor(n/16)),("x"===t?r:3&r|8).toString(16)})}function i(t){return t.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$/i)}n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));class r{static fromCart(t,e){const n=new r;return n.line_items=t.lineItems.map(t=>{var n,r,i,o,s;return{productId:t.productId,key:e(t),quantity:t.quantity,group:null===(n=t.props)||void 0===n?void 0:n._group,userId:null===(r=t.props)||void 0===r?void 0:r._userId,stateId:null===(i=t.props)||void 0===i?void 0:i._stateId,hidden:null===(o=t.props)||void 0===o?void 0:o._hidden,fields:null===(s=t.props)||void 0===s?void 0:s._fields,properties:t.props}}),n}}},function(t,e,n){"use strict";
/*!
 * Strongly Typed Events for TypeScript - Core
 * https://github.com/KeesCBakker/StronlyTypedEvents/
 * http://keestalkstech.com
 *
 * Copyright Kees C. Bakker / KeesTalksTech
 * Released under the MIT license
 */Object.defineProperty(e,"__esModule",{value:!0}),e.Subscription=e.EventListBase=e.DispatcherWrapper=e.DispatcherBase=void 0;var r=n(47);Object.defineProperty(e,"DispatcherBase",{enumerable:!0,get:function(){return r.DispatcherBase}}),Object.defineProperty(e,"DispatcherWrapper",{enumerable:!0,get:function(){return r.DispatcherWrapper}}),Object.defineProperty(e,"EventListBase",{enumerable:!0,get:function(){return r.EventListBase}});var i=n(45);Object.defineProperty(e,"Subscription",{enumerable:!0,get:function(){return i.Subscription}})},function(t,e,n){"use strict";
/*!
 * Strongly Typed Events for TypeScript
 * https://github.com/KeesCBakker/StronlyTypedEvents/
 * http://keestalkstech.com
 *
 * Copyright Kees C. Bakker / KeesTalksTech
 * Released under the MIT license
 */Object.defineProperty(e,"__esModule",{value:!0}),e.SignalList=e.SignalHandlingBase=e.SignalDispatcher=e.NonUniformSimpleEventList=e.SimpleEventList=e.SimpleEventHandlingBase=e.SimpleEventDispatcher=e.NonUniformEventList=e.EventList=e.EventHandlingBase=e.EventDispatcher=e.Subscription=e.EventListBase=e.DispatcherWrapper=e.DispatcherBase=void 0;var r=n(43);Object.defineProperty(e,"DispatcherBase",{enumerable:!0,get:function(){return r.DispatcherBase}}),Object.defineProperty(e,"DispatcherWrapper",{enumerable:!0,get:function(){return r.DispatcherWrapper}}),Object.defineProperty(e,"EventListBase",{enumerable:!0,get:function(){return r.EventListBase}}),Object.defineProperty(e,"Subscription",{enumerable:!0,get:function(){return r.Subscription}});var i=n(49);Object.defineProperty(e,"EventDispatcher",{enumerable:!0,get:function(){return i.EventDispatcher}}),Object.defineProperty(e,"EventHandlingBase",{enumerable:!0,get:function(){return i.EventHandlingBase}}),Object.defineProperty(e,"EventList",{enumerable:!0,get:function(){return i.EventList}}),Object.defineProperty(e,"NonUniformEventList",{enumerable:!0,get:function(){return i.NonUniformEventList}});var o=n(51);Object.defineProperty(e,"SimpleEventDispatcher",{enumerable:!0,get:function(){return o.SimpleEventDispatcher}}),Object.defineProperty(e,"SimpleEventHandlingBase",{enumerable:!0,get:function(){return o.SimpleEventHandlingBase}}),Object.defineProperty(e,"SimpleEventList",{enumerable:!0,get:function(){return o.SimpleEventList}}),Object.defineProperty(e,"NonUniformSimpleEventList",{enumerable:!0,get:function(){return o.NonUniformSimpleEventList}});var s=n(5);Object.defineProperty(e,"SignalDispatcher",{enumerable:!0,get:function(){return s.SignalDispatcher}}),Object.defineProperty(e,"SignalHandlingBase",{enumerable:!0,get:function(){return s.SignalHandlingBase}}),Object.defineProperty(e,"SignalList",{enumerable:!0,get:function(){return s.SignalList}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Subscription=void 0;var r=function(){function t(t,e){this.handler=t,this.isOnce=e,this.isExecuted=!1}return t.prototype.execute=function(t,e,n){if(!this.isOnce||!this.isExecuted){this.isExecuted=!0;var r=this.handler;t?setTimeout((function(){r.apply(e,n)}),1):r.apply(e,n)}},t}();e.Subscription=r},,function(t,e,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r};Object.defineProperty(e,"__esModule",{value:!0}),e.DispatcherWrapper=e.EventListBase=e.DispatcherBase=void 0;var i=n(48),o=n(45),s=function(){function t(){this._wrap=new c(this),this._subscriptions=new Array}return Object.defineProperty(t.prototype,"count",{get:function(){return this._subscriptions.length},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t){var e=this;return t&&this._subscriptions.push(new o.Subscription(t,!1)),function(){e.unsubscribe(t)}},t.prototype.sub=function(t){return this.subscribe(t)},t.prototype.one=function(t){var e=this;return t&&this._subscriptions.push(new o.Subscription(t,!0)),function(){e.unsubscribe(t)}},t.prototype.has=function(t){return!!t&&this._subscriptions.some((function(e){return e.handler==t}))},t.prototype.unsubscribe=function(t){if(t)for(var e=0;e<this._subscriptions.length;e++)if(this._subscriptions[e].handler==t){this._subscriptions.splice(e,1);break}},t.prototype.unsub=function(t){this.unsubscribe(t)},t.prototype._dispatch=function(t,e,n){for(var o=this,s=function(r){var s=new i.EventManagement((function(){return o.unsub(r.handler)})),c=Array.prototype.slice.call(n);if(c.push(s),r.execute(t,e,c),a.cleanup(r),!t&&s.propagationStopped)return"break"},a=this,c=0,u=r(this._subscriptions);c<u.length;c++){if("break"===s(u[c]))break}},t.prototype.cleanup=function(t){if(t.isOnce&&t.isExecuted){var e=this._subscriptions.indexOf(t);e>-1&&this._subscriptions.splice(e,1)}},t.prototype.asEvent=function(){return this._wrap},t.prototype.clear=function(){this._subscriptions.splice(0,this._subscriptions.length)},t}();e.DispatcherBase=s;var a=function(){function t(){this._events={}}return t.prototype.get=function(t){var e=this._events[t];return e||(e=this.createDispatcher(),this._events[t]=e,e)},t.prototype.remove=function(t){delete this._events[t]},t}();e.EventListBase=a;var c=function(){function t(t){this._subscribe=function(e){return t.subscribe(e)},this._unsubscribe=function(e){return t.unsubscribe(e)},this._one=function(e){return t.one(e)},this._has=function(e){return t.has(e)},this._clear=function(){return t.clear()},this._count=function(){return t.count}}return Object.defineProperty(t.prototype,"count",{get:function(){return this._count()},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t){return this._subscribe(t)},t.prototype.sub=function(t){return this.subscribe(t)},t.prototype.unsubscribe=function(t){this._unsubscribe(t)},t.prototype.unsub=function(t){this.unsubscribe(t)},t.prototype.one=function(t){return this._one(t)},t.prototype.has=function(t){return this._has(t)},t.prototype.clear=function(){this._clear()},t}();e.DispatcherWrapper=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventManagement=void 0;var r=function(){function t(t){this.unsub=t,this.propagationStopped=!1}return t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}();e.EventManagement=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NonUniformEventList=e.EventList=e.EventHandlingBase=e.EventDispatcher=void 0;var r=n(50);Object.defineProperty(e,"EventDispatcher",{enumerable:!0,get:function(){return r.EventDispatcher}}),Object.defineProperty(e,"EventHandlingBase",{enumerable:!0,get:function(){return r.EventHandlingBase}}),Object.defineProperty(e,"EventList",{enumerable:!0,get:function(){return r.EventList}}),Object.defineProperty(e,"NonUniformEventList",{enumerable:!0,get:function(){return r.NonUniformEventList}})},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.EventHandlingBase=e.EventList=e.NonUniformEventList=e.EventDispatcher=void 0;var o=n(43),s=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.dispatch=function(t,e){this._dispatch(!1,this,arguments)},e.prototype.dispatchAsync=function(t,e){this._dispatch(!0,this,arguments)},e.prototype.asEvent=function(){return t.prototype.asEvent.call(this)},e}(o.DispatcherBase);e.EventDispatcher=s;var a=function(){function t(){this._events={}}return t.prototype.get=function(t){if(this._events[t])return this._events[t];var e=this.createDispatcher();return this._events[t]=e,e},t.prototype.remove=function(t){delete this._events[t]},t.prototype.createDispatcher=function(){return new s},t}();e.NonUniformEventList=a;var c=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.createDispatcher=function(){return new s},e}(o.EventListBase);e.EventList=c;var u=function(){function t(){this._events=new c}return Object.defineProperty(t.prototype,"events",{get:function(){return this._events},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t,e){this._events.get(t).subscribe(e)},t.prototype.sub=function(t,e){this.subscribe(t,e)},t.prototype.unsubscribe=function(t,e){this._events.get(t).unsubscribe(e)},t.prototype.unsub=function(t,e){this.unsubscribe(t,e)},t.prototype.one=function(t,e){this._events.get(t).one(e)},t.prototype.has=function(t,e){return this._events.get(t).has(e)},t}();e.EventHandlingBase=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.NonUniformSimpleEventList=e.SimpleEventList=e.SimpleEventHandlingBase=e.SimpleEventDispatcher=void 0;var r=n(52);Object.defineProperty(e,"SimpleEventDispatcher",{enumerable:!0,get:function(){return r.SimpleEventDispatcher}}),Object.defineProperty(e,"SimpleEventHandlingBase",{enumerable:!0,get:function(){return r.SimpleEventHandlingBase}}),Object.defineProperty(e,"SimpleEventList",{enumerable:!0,get:function(){return r.SimpleEventList}}),Object.defineProperty(e,"NonUniformSimpleEventList",{enumerable:!0,get:function(){return r.NonUniformSimpleEventList}})},function(t,e,n){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleEventHandlingBase=e.SimpleEventList=e.NonUniformSimpleEventList=e.SimpleEventDispatcher=void 0;var o=n(43),s=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.dispatch=function(t){this._dispatch(!1,this,arguments)},e.prototype.dispatchAsync=function(t){this._dispatch(!0,this,arguments)},e.prototype.asEvent=function(){return t.prototype.asEvent.call(this)},e}(o.DispatcherBase);e.SimpleEventDispatcher=s;var a=function(){function t(){this._events={}}return t.prototype.get=function(t){if(this._events[t])return this._events[t];var e=this.createDispatcher();return this._events[t]=e,e},t.prototype.remove=function(t){delete this._events[t]},t.prototype.createDispatcher=function(){return new s},t}();e.NonUniformSimpleEventList=a;var c=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.createDispatcher=function(){return new s},e}(o.EventListBase);e.SimpleEventList=c;var u=function(){function t(){this._events=new c}return Object.defineProperty(t.prototype,"events",{get:function(){return this._events},enumerable:!1,configurable:!0}),t.prototype.subscribe=function(t,e){this._events.get(t).subscribe(e)},t.prototype.sub=function(t,e){this.subscribe(t,e)},t.prototype.one=function(t,e){this._events.get(t).one(e)},t.prototype.has=function(t,e){return this._events.get(t).has(e)},t.prototype.unsubscribe=function(t,e){this._events.get(t).unsubscribe(e)},t.prototype.unsub=function(t,e){this.unsubscribe(t,e)},t}();e.SimpleEventHandlingBase=u},,function(t,e,n){"use strict";n.r(e);var r=n(3),i=n(6);class o{constructor(t){this._apiClient=t}async findById(t){const e=await this._apiClient.getTemplateIntegrationInfo(t);return e.externalProductId="",e}async findByProduct(t){const e=await this._apiClient.getIntegrationInfo(t);return e.externalProductId=t,e}}var s=n(16);var a=n(4);async function c(t){const e=[{importData:"editor",url:t.uiFrameworkUrl+"/editor.js",isDefault:!0},{importData:"ecommerceDriver",url:u(t)}],n=await Object(a.a)(e);return{editor:n[0].editor,driver:n[1].ecommerceDriver}}function u(t){switch(t.configFamily){case r.a.SimpleEditor:return t.simpleEditorUrl+p(t.ecommerceSystemType);case r.a.UIFramework:return t.uiFrameworkUrl+p(t.ecommerceSystemType);default:throw new Error("Failed to recognize config family: "+t.configFamily)}}function p(t){switch(t){case r.b.Shopify:return"/drivers/shopify-driver.js";case r.b.NopCommerce:return"/drivers/nopcommerce-driver.js";case r.b.WooCommerce:return"/drivers/woocommerce-driver.js";case r.b.Magento:return"/drivers/magento-driver.js";case r.b.BigCommerce:return"/drivers/bigcommerce-driver.js";default:return"/drivers/default-driver.js"}}class f{constructor(t){this._apiClient=t}async getBackOfficeCredentials(t,e){return await this._apiClient.getTokenAndUserId(t,e)}async getEditorToken(t,e){return await this._apiClient.getCcToken(t,e)}async updateEditorToken(t){return await this._apiClient.updateCcToken(t)}}var l=n(42),d=n(41);n(17);class h{constructor(){this.useProjectBuffer=!0}}var m=n(44);class v extends m.EventDispatcher{constructor(){super(...arguments),this.callbacks=new Array}subscribe(t){return t&&this.callbacks.push(new m.Subscription(t,!1)),()=>{this.unsubscribe(t)}}unsubscribe(t){if(t)for(let e=0;e<this.callbacks.length;e++)if(this.callbacks[e].handler===t){this.callbacks.splice(e,1);break}}dispatch(t,e){const n=this.callbacks.map(n=>this.executeCallback(n,t,e));return Promise.all(n).then(()=>{})}executeCallback(t,e,n){const r=t.handler.apply(this,[e,n]);return this.isPromise(r)?r:Promise.resolve()}isPromise(t){return!!t&&"function"==typeof t.then}}class b{constructor(t){this._apiClient=t}async findByVersionId(t,e){const n=await this._apiClient.getOptionBasedProductIntegrationInfo(t,e);return n.externalProductId="",n}async findByProduct(t){const e=await this._apiClient.getIntegrationInfo(t);return e.externalProductId=t,e}}class g{constructor(){this.options=new h}}class y{}class _{constructor(t){var e,n;this._onEditorFinish=new v,this.createBogusProduct=()=>({id:0,Id:0,sku:"PRODUCT-001",title:"Test Product",description:"This is a test product.",options:[],price:1,attributes:[],variants:[{id:1,optionNames:[]}]}),this.options=t,this._apiClient=new i.a(t.tenantId,null!==(e=t.backOfficeUrl)&&void 0!==e?e:"https://customerscanvashub.com/",null!==(n=t.ecommerceSystemId)&&void 0!==n?n:0),this.templateService=new o(this._apiClient),this.optionBasedProductService=new b(this._apiClient),this.userService=new f(this._apiClient)}get onFinish(){return this._onEditorFinish.asEvent()}get templates(){return this.templateService}get optionBasedProducts(){return this.optionBasedProductService}async _prefetchData(t,e){if(this._apps&&this._backOfficeUserData&&this._userToken)return{apps:this._apps,backOfficeUserData:this._backOfficeUserData,userToken:this._userToken};const[n,r,i]=await Promise.all([c(t),this.userService.getBackOfficeCredentials(e.id,window.location.origin),this.userService.getEditorToken(e.id,window.location.origin)]);return this._apps=n,this._backOfficeUserData=r,this._userToken=i,{apps:n,backOfficeUserData:r,userToken:i}}async preload(t,e){const{apps:n,backOfficeUserData:r,userToken:i}=await this._prefetchData(t,e);await n.editor.preload({designEditorUrl:t.customerCanvasUrl})}async loadEditor(t,e,n,r,i){const o=await this.prepareEditor(e,n,r,i);return window.Aurigma=Object.assign(window.Aurigma||{},{driver:o.driver}),await this.renderEditor(o.driver,t)}async prepareEditor(t,e,n,i){var o,s,a,c;null!=n||(n=this.createBogusProduct());const{apps:u,backOfficeUserData:p,userToken:f}=await this._prefetchData(t,e);let h=this.prepareConfig(t.config);const m=this.getEditorSettings(t,this.options.pluginSettings);m.language&&(h.language=m.language);this.options.ecommerceDomain&&""!=this.options.ecommerceDomain?this.options.ecommerceDomain:window.location.origin;const v=null!==(o=e.token)&&void 0!==o?o:f;setInterval(async()=>{await this._apiClient.updateCcToken(v)},18e5);let b=[];if(h.additionalProducts&&h.additionalProducts.length>0){try{b=await this._apiClient.getAdditionalProducts(this.options.tenantId,window.location.origin,h.additionalProducts)}catch(t){try{b=h.additionalProducts.map(t=>window.Aurigma.Storefront.allProducts.find(e=>e.id==t.id))}catch(t){}}if(0===b.length)try{b=h.additionalProducts.map(t=>window.Aurigma.Storefront.allProducts.find(e=>e.id==t.id))}catch(t){}}return u.driver=await u.driver.init(b.length>0?[n].concat(b):n,u.editor,h,m,i,n.quantity,{id:e.id,tokenId:v,data:e.data},{storefrontId:null!==(s=t.ecommerceSystemId)&&void 0!==s?s:"",apiGatewayUrl:null!==(a=t.apiGatewayUrl)&&void 0!==a?a:"",backOfficeUrl:null!==(c=this.options.backOfficeUrl)&&void 0!==c?c:"https://customerscanvashub.com/",assetProcessorUrl:t.assetProcessorUrl,assetStorageUrl:t.assetStorageUrl,designAtomsApiUrl:t.designAtomsApiUrl,tenantId:this.options.tenantId,userId:p.userId,token:p.token,externalProductId:t.externalProductId,integrationType:t.integrationType}),u.driver.config.vars=u.driver.config.vars||{},u.driver.config.vars.token=p.token,u.driver.config.vars.backOfficeUserId=p.userId,u.driver.config.vars.unitId=this.options.tenantId,t.ecommerceSystemType==r.b.NopCommerce&&(u.driver.settings.useBackOffice=!0,u.driver.orders.forEach(t=>{t.useBackOffice=!0})),t.templateAttributes&&this.putAttributesToDriver(t.templateAttributes.map(t=>({name:t.name,title:t.name,value:t.value})),u.driver),u.driver.cart.onSubmitting.subscribe(async t=>{await this._onEditorFinish.dispatch(this,l.a.fromCart(t,t=>Object(d.a)()))}),u}async renderEditor(t,e){return e.innerHTML="",t.products.current.renderEditor(e,this.options.themeSettings,this.options.localization,!0),new Promise((n,r)=>{e.addEventListener("load",()=>{n(t)})})}putAttributesToDriver(t,e){t.forEach(t=>{try{const e=JSON.parse(t.value);"object"==typeof e&&(t.value=e)}catch(t){}}),e.products.current.attributes.push(...t)}prepareConfig(t){var e,n;let r=JSON.parse(t);r=null!==(e=r.config)&&void 0!==e?e:r;const i=new s.a(document).getLanguage();return null!==(n=r.language)&&void 0!==n||(r.language=i),r}getEditorSettings(t,e){switch(t.ecommerceSystemType){case r.b.Shopify:return Object.assign(Object.assign({},e),{editorUrl:t.customerCanvasUrl,customersCanvasBaseUrl:t.customerCanvasUrl,dynamicImageUrl:t.dynamicImageUrl,diUrl:t.dynamicImageUrl,preflightToolUrl:t.preflightUrl,preflightUrl:t.preflightUrl});case r.b.NopCommerce:return Object.assign(Object.assign({},e),{ServerHostUrl:t.customerCanvasUrl,DynamicImageUrl:t.dynamicImageUrl,PreflightToolUrl:t.preflightUrl});case r.b.WooCommerce:return Object.assign(Object.assign({},e),{dynamicImageUrl:t.dynamicImageUrl,preflightToolUrl:t.preflightUrl,customersCanvasBaseUrl:t.customerCanvasUrl});case r.b.Magento:return Object.assign(Object.assign({},e),{dynamicImageUrl:t.dynamicImageUrl,preflightToolUrl:t.preflightUrl,customersCanvasBaseUrl:t.customerCanvasUrl});case r.b.BigCommerce:return Object.assign(Object.assign({},e),{dynamicImageUrl:t.dynamicImageUrl,preflightToolUrl:t.preflightUrl,customersCanvasBaseUrl:t.customerCanvasUrl});case r.b.Custom:default:return Object.assign(Object.assign({},e),{customersCanvasUrl:t.customerCanvasUrl,customersCanvasBaseUrl:t.customerCanvasUrl,dynamicImageUrl:t.dynamicImageUrl,preflightToolUrl:t.preflightUrl})}}}n.d(e,"BackOfficeOptions",(function(){return g})),n.d(e,"User",(function(){return y})),n.d(e,"BackOffice",(function(){return _})),window.BackOffice=window.BackOffice||{},window.BackOffice.Storefront=window.BackOffice.Storefront||{},window.BackOffice.Storefront=Object.assign(window.BackOffice.Storefront,{version:"1.2.4"})}]);